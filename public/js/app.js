let chars =[
{
        "name": "Select the character",
        "img" : "https://i.pinimg.com/originals/ab/b8/d1/abb8d166d497a191faeb8d31a02b8098.png",
        "ele" : "",
        "p_dps": "",
        "p_heal": "",
        "p_shield": "",
        "p_cc" : "",
        "p_boost" :"",
        "p_eleSpread": "",
        "p_burst" : "" 
},    
{
    "name": "Diluc",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Diluc.png",
    "ele" : "Pyro",
        "p_dps": 100,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 65,
        "p_burst" : 30  
    
},
{
    "name": "Amber",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Amber.png",
    "ele" : "Pyro",
        "p_dps": 20,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 20,
        "p_boost" :0,
        "p_eleSpread": 40,
        "p_burst" : 15  
},
{
    "name": "Barbara",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Barbara.png",
    "ele" : "Hydro",
        "p_dps": 5,
        "p_heal": 80,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 65,
        "p_burst" : 0  
},
{
    "name": "Beidou",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Beidou.png",
    "ele" : "Electro",
        "p_dps": 50,
        "p_heal": 0,
        "p_shield": 25,
        "p_cc" : 0,
        "p_boost" : 0,
        "p_eleSpread": 45,
        "p_burst" : 45  
},
{
    "name": "Bennet",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Bennett.png",
    "ele" : "Pyro",
        "p_dps": 35,
        "p_heal": 70,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :100,
        "p_eleSpread": 40,
        "p_burst" : 10  
},
{
    "name": "Chongyun",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Chongyun.png",
    "ele" : "Cryo",
        "p_dps": 60,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 75,
        "p_burst" : 45  
},
{
    "name": "Diona",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Diona.png",
    "ele" : "Cryo",
        "p_dps": 0,
        "p_heal": 45,
        "p_shield": 60,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 50,
        "p_burst" : 15  
},
{
    "name": "Fischl",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Fischl.png",
    "ele" : "Electro",
        "p_dps": 60,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" : 0,
        "p_eleSpread": 75,
        "p_burst" : 35  
},
{
    "name": "Jean",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Jean.png",
    "ele" : "Anemo",
        "p_dps": 50,
        "p_heal": 95,
        "p_shield": 0,
        "p_cc" : 45,
        "p_boost" :0,
        "p_eleSpread": 55,
        "p_burst" : 75  
},
{
    "name": "Kaeya",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Kaeya.png",
    "ele" : "Cryo",
        "p_dps": 25,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" : 0,
        "p_eleSpread": 55,
        "p_burst" : 15  
},
{
    "name": "Keqing",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Keqing.png",
    "ele" : "",
        "p_dps": 80,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" : 0,
        "p_eleSpread": 65,
        "p_burst" : 45  
},
{
    "name": "Klee",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Klee.png",
    "ele" : "Pyro",
        "p_dps": 100,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" : 0,
        "p_eleSpread": 65,
        "p_burst" : 25  
},
{
    "name": "Lisa",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Lisa.png",
    "ele" : "Electro",
        "p_dps": 50,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 45,
        "p_burst" : 50  
},
{
    "name": "Mona",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Mona.png",
    "ele" : "Hydro",
        "p_dps": 55,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 75,
        "p_boost" :75,
        "p_eleSpread": 65,
        "p_burst" : 80  
},
{
    "name": "Ningguang",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Ningguang.png",
    "ele" : "Geo",
        "p_dps": 75,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 15,
        "p_burst" : 80  
},
{
    "name": "Noelle",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Noelle.png",
    "ele" : "Geo",
        "p_dps": 30,
        "p_heal": 35,
        "p_shield": 60,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 15,
        "p_burst" : 25  
},
{
    "name": "Qiqi",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Qiqi.png",
    "ele" : "Cryo",
        "p_dps": 25,
        "p_heal": 100,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 55,
        "p_burst" : 0  
},
{
    "name": "Razor",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Razor.png",
    "ele" : "Electro",
        "p_dps": 80,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0 ,
        "p_boost" :0 ,
        "p_eleSpread": 35,
        "p_burst" : 20  
},
{
    "name": "Tartaglia",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Tartaglia.png",
    "ele" : "Hydro",
        "p_dps": 85,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 55,
        "p_burst" : 75  
    
},
{
    "name": "Sucrose",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Sucrose.png",
    "ele" : "Anemo",
        "p_dps": 40,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 70,
        "p_boost" :0,
        "p_eleSpread": 80,
        "p_burst" : 35  
},
{
    "name": "Atraveler",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Traveler%20(Anemo).png",
    "ele" : "Anemo",
        "p_dps": 30,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 55,
        "p_boost" : 0 ,
        "p_eleSpread": 50,
        "p_burst" : 25  
},
{
    "name": "Gtraveler",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Traveler%20(Geo).png",
    "ele" : "Geo",
        "p_dps": 30,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 20,
        "p_boost" :0,
        "p_eleSpread": 15,
        "p_burst" : 45  
},
{
    "name": "Venti",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Venti.png",
    "ele" : "Anemo",
        "p_dps": 30,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 80,
        "p_boost" :0,
        "p_eleSpread": 80,
        "p_burst" : 70  
},
{
    "name": "Xiangling",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Xiangling.png",
    "ele" : "Pyro",
        "p_dps": 60,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :15,
        "p_eleSpread": 75,
        "p_burst" : 50  
},
{
    "name": "Xiao",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Xiao.png",
    "ele" : "Anemo",
        "p_dps": 100,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 0,
        "p_burst" : 40  
},
{
    "name": "Xingqiu",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Xingqiu.png",
    "ele" : "Hydro",
        "p_dps": 35,
        "p_heal": 35,
        "p_shield": 15,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 65,
        "p_burst" : 65  
},
{
    "name": "Xinyan",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Xinyan.png",
    "ele" : "Pyro",
        "p_dps": 55,
        "p_heal": 0,
        "p_shield": 55,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 35,
        "p_burst" : 75  
},
{
    "name": "Zhongli",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Zhongli.png",
    "ele" : "Geo",
        "p_dps": 30,
        "p_heal": 0,
        "p_shield": 100,
        "p_cc" : 60,
        "p_boost" :0,
        "p_eleSpread": 15,
        "p_burst" : 80  
},
{
    "name": "Albedo",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Albedo.png",
    "ele" : "Geo",
        "p_dps": 60,
        "p_heal": 0,
        "p_shield": 45,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 45,
        "p_burst" : 45  
},
{
    "name": "Ganyu",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Ganyu.png",
    "ele" : "Cryo",
        "p_dps": 98,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 25,
        "p_boost" :0,
        "p_eleSpread": 90,
        "p_burst" : 75  
},
{
    "name": "HuTao",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Hu%20Tao.png",
    "ele" : "Pyro",
        "p_dps": 100,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 65,
        "p_burst" : 80  
    
},
        {
    "name": "Rosaria",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Rosaria.png",
    "ele" : "Cryo",
        "p_dps": 70,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 50,
        "p_burst" : 30  
    
},
        {
    "name": "Yanfei",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Yanfei.png",
    "ele" : "Pyro",
        "p_dps": 75,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 68,
        "p_burst" : 60  
    
}
        ,
        {
    "name": "Eula",
    "img" : "https://rerollcdn.com/GENSHIN/Characters/Eula.png",
    "ele" : "Cryo",
        "p_dps": 100,
        "p_heal": 0,
        "p_shield": 0,
        "p_cc" : 0,
        "p_boost" :0,
        "p_eleSpread": 35,
        "p_burst" : 100  
    
}
]
     
let maindps;
let supdps;
let sup1;
let sup2;

const form = document.querySelectorAll('.form-select');
const resbtn = document.querySelector('.res-btn')
const result = document.querySelector('.result-table')


// events
form.forEach(item => {item.addEventListener('click', function(e){
    if(e.target.value!== "Select the character" && e.target.value && item.classList.contains('s_maindps')){
        maindps = e.target.value;
        console.log(maindps);
        const temp = document.querySelector('.is1');
        const link = get_img(maindps);
        
        temp.innerHTML= `<img src="${link}" 
        class="rounded mx-auto d-block img-fluid" alt="defaultSelect"></img>`; 
    }
    if(e.target.value!== "Select the character" && e.target.value && item.classList.contains('s_supdps')){
        supdps = e.target.value;
        console.log(supdps);
        const temp = document.querySelector('.is2');
        const link = get_img(supdps);
        
        temp.innerHTML= `<img src="${link}" 
        class="rounded mx-auto d-block img-fluid" alt="defaultSelect"></img>`; 
    }
    if(e.target.value!== "Select the character" && e.target.value && item.classList.contains('s_sup1')){
        sup1 = e.target.value;
        console.log(sup1);
        const temp = document.querySelector('.is3');
        const link = get_img(sup1);
        
        temp.innerHTML= `<img src="${link}" 
        class="rounded mx-auto d-block img-fluid" alt="defaultSelect"></img>`; 
    }
    if(e.target.value!== "Select the character" && e.target.value && item.classList.contains('s_sup2')){
        sup2 = e.target.value;
        console.log(sup2);
        const temp = document.querySelector('.is4');
        const link = get_img(sup2);
        
        temp.innerHTML= `<img src="${link}" 
        class="rounded mx-auto d-block img-fluid" alt="defaultSelect"></img>`; 
    }
})});

resbtn.addEventListener('click', get_results);

//functions
let ressonance= "none";

function get_results(){
    console.log("gerando resultados");

    var check = finddups();

    if(check){
        if(maindps && supdps && sup1 && sup2){
            result.style.backgroundColor = 'rgba(69, 170, 64, 1)';
            result.textContent= `seu time é : ${maindps}, ${supdps}, ${sup1}, ${sup2}`;
            calcPower();
        } else{
            result.style.backgroundColor = 'rgba(170, 64, 64, 1)';
            result.textContent= `Complete seu time primeiro`;
        }
    } else {
        result.style.backgroundColor = 'rgba(170, 64, 64, 1)';
        result.textContent= `Não use personagens repetidos`;
    }
   
}

function get_img(charz){

    if(charz){
    let char = chars.find(char => char.name === charz);
    return char.img;
    };

}

function finddups(){
 let c1= [maindps,supdps,sup1,sup2];
 c1 = [...new Set(c1)]; // get unique value
 
 if(c1.length !== 4){
     return false;
 }
 return true;
}

function calcPower(){
    const dps = chars.find(char => char.name === maindps);
    const subdps = chars.find(char => char.name === supdps);
    const support1 = chars.find(char => char.name === sup1);
    const support2 = chars.find(char => char.name === sup2);

    const team = [dps,subdps,support1,support2];

    console.log(team[0].ele);

    var dps_power = calcDps(team);
    var subdps_power = calcSub(team);
    var sup_power = calcSup(team);
    var react = 0;

    if(ressonance === "Pyro"){
        dps_power = dps_power + (dps_power* 0.2);
    } else 
    if(ressonance === "Hydro"){
        sup_power = sup_power + (sup_power* 0.1);
    } else 
    if(ressonance === "Cryo" && dps.ele == "Cryo"){
        dps_power = dps_power + (dps_power* 0.2);
    } else
    if(ressonance === "Electro" && dps.ele == "Electro"){
        dps_power = dps_power + (sup_power* 0.1);
    }

    var result = dps_power + subdps_power + sup_power;

    displayResults(result);
}

function calcDps(team){
    final = team[0].p_dps *4;

    final = final + final*calcElements(team);
    return final;
}
function calcSub(team){
    final = team[1].p_dps + team[1].p_burst + team[1].p_eleSpread;
    final = final + ((team[1].p_heal + team[1].p_shield)* 0.25) + (team[1].p_cc * 0.5) ;
    return final;
}
function calcSup(team){
    final = (team[2].p_heal* 1.2) + (team[2].p_shield* 1.2) + (team[2].p_boost* 1.5);
    final = final + (team[3].p_heal* 1.2) + (team[3].p_shield* 1.2) + (team[3].p_boost* 1.5);  
    final = final + (team[2].p_burst + team[3].p_burst);
    return final;
}

function calcElements(team){
    return calcElements2(team[0].ele, team[1].ele, team[2].ele, team[3].ele);
}

function calcElements2(ele1, ele2, ele3, ele4){
    var final= 0;

    if(ele1 === "Pyro"){
        if(ele2 == "Hydro"){
            final = final + 0.2;
        } else
        if(ele2 == "Cryo"){
            final = final + 0.3;
        } else
        if(ele2 == "Electro"){
            final = final + 0.1;
        } else {
            final = final + 0;
        }

        if (ele3 === "Hydro" || ele4 === "Hydro"){
            final = final + 0.05;
        }
        if (ele3 === "Cryo" || ele4 === "Cryo"){
            final = final + 0.08;
        }
        if (ele3 === "Electro" || ele4 === "Electro"){
            final = final + 0.025;
        }
    }

    if(ele1 === "Cryo"){
        if(ele2 == "Hydro"){
            final = final + 0.1;
        } else
        if(ele2 == "Pyro"){
            final = final + 0.3;
        } else
        if(ele2 == "Electro"){
            final = final + 0.1;
        } else {
            final = final + 0;
        }

        if (ele3 === "Hydro" || ele4 === "Hydro"){
            final = final + 0.03;
        }
        if (ele3 === "Pyro" || ele4 === "Pyro"){
            final = final + 0.08;
        }
        if (ele3 === "Electro" || ele4 === "Electro"){
            final = final + 0.01;
        }
    }

    if(ele1 === "Electro"){
        if(ele2 == "Hydro"){
            final = final + 0.4;
        } else
        if(ele2 == "Pyro"){
            final = final + 0.1;
        } else
        if(ele2 == "Cryo"){
            final = final + 0.1;
        } else {
            final = final + 0;
        }

        if (ele3 === "Hydro" || ele4 === "Hydro"){
            final = final + 0.08;
        }
        if (ele3 === "Pyro" || ele4 === "Pyro"){
            final = final + 0.03;
        }
        if (ele3 === "Cryo" || ele4 === "Cryo"){
            final = final + 0.01;
        }
    }

    if(ele1 == "Hydro"){
        if(ele2 == "Cryo"){
            final = final + 0.1;
        } else
        if(ele2 == "Pyro"){
            final = final + 0.3;
        } else
        if(ele2 == "Electro"){
            final = final + 0.2;
        } else {
            final = final + 0;
        }

        if (ele3 === "Cryo" || ele4 === "Cryo"){
            final = final + 0.03;
        }
        if (ele3 === "Pyro" || ele4 === "Pyro"){
            final = final + 0.08;
        }
        if (ele3 === "Electro" || ele4 === "Electro"){
            final = final + 0.08;
        }
    }


    var elecod = [ele1,ele2,ele3,ele4];
    var pyrocount= 0;
    var hydrocount= 0;
    var electrocount= 0;
    var cryocount = 0;
  
    elecod.forEach(item => {
        if(item == "Pyro"){pyrocount ++;}
        if(item == "Hydro"){hydrocount ++;}
        if(item == "Electro"){electrocount ++;}
        if(item == "Cryo"){cryocount ++;}
    })

    if(pyrocount >= 2){
        ressonance = "Pyro";
    } else
    if(hydrocount >= 2){
        ressonance = "Hydro";
    } else
    if(electrocount >= 2){
        ressonance = "Electro";
    } else
    if(cryocount >= 2){
        ressonance = "Cryo";
    }; 

    return final;
}

function displayResults(result){
    console.log(result);
    total = document.querySelector('.total-result');
    totalmsg= document.querySelector('.result-msg');
    if(result < 100){
        total.innerHTML = `
        <div class="progress">
  <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
</div>
        `
    } else if(result > 100 && result < 400){
        total.innerHTML = `<div class="progress">
        <div class="progress-bar bg-danger" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
      </div>`;
      totalmsg.style.backgroundColor = 'rgba(170, 64, 64, 1)'; 
      totalmsg.innerHTML = `<p>Seu time é C tier</p>`;
    }else if(result > 400 && result < 700){
        total.innerHTML = `<div class="progress">
        <div class="progress-bar bg-warning" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
      </div>`
      totalmsg.style.backgroundColor = 'rgba(121, 64, 98, 1)'; 
      totalmsg.innerHTML = `<p>Seu time é B tier</p>`;
    }
    else if(result > 700 && result < 945){
        total.innerHTML = `<div class="progress">
        <div class="progress-bar bg-info" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
      </div>`
      totalmsg.style.backgroundColor = 'rgba(64, 64, 164, 1)'; 
      totalmsg.innerHTML = `<p>Seu time é A tier</p>`;
    } else {
        total.innerHTML = `<div class="progress">
        <div class="progress-bar bg-success" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
      </div>`
      totalmsg.style.backgroundColor = 'rgba(64, 164, 64, 1)'; 
      totalmsg.innerHTML = `<p>Seu time é S tier</p>`;
    }

}
// end of functions

